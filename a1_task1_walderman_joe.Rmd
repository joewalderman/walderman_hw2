---
title: "Mountain Yellow-Legged Frogs in the Southern Sierra Nevada"
author: "Joe Walderman"
date: "1/17/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE, options(scipen = 999999))
library(tidyverse)
library(janitor)
library(here)
library(readxl)
library(lubridate)
library(patchwork)
``` 



```{r readxl, echo=FALSE, eval=TRUE, warning=FALSE}
## Reading in data and wrangling
amphib <- read_excel(here("data", "sierra_amphibians.xlsx") ) %>% 
  clean_names() %>% 
  drop_na() %>% 
  mutate(across(where(is.character), tolower)) %>% # convert all characters to lowercase
  mutate(date = ymd(survey_date)) %>%
  mutate(year = year(date))

amphib_count <- amphib %>% 
  filter(amphibian_life_stage != "eggmass", #removing observations with eggmass
         amphibian_species == "ramu",
         amphibian_location == "in lake") %>% #filtering for only desired species
  group_by(year, amphibian_life_stage) %>% 
  summarise(frogs = sum(amphibian_number))

amphib_old <- amphib %>% 
  filter(amphibian_life_stage %in% c("adult", "subadult"),
         amphibian_species == "ramu",
         amphibian_location == "in lake") %>% 
  group_by(lake_id) %>% 
  summarise(frogs = sum(amphibian_number)) %>% 
  slice_max(frogs, n = 5) #top 5 lakes by count

amphib_old$lake <- as.factor(amphib_old$lake_id) #converting from numeric to factor for graph aesthetics

graph_a <- ggplot(data = amphib_count, aes(x = year, y = frogs)) +
  geom_line(aes(color = amphibian_life_stage), size = 0.5) +
  labs(y = "Frog Count",
       x = "Year",
       title = "Yearly Change in Frog Counts by Life Stage",
       color = "Life Stage") +
  scale_x_continuous(breaks = c(1995:2002)) +
  theme_minimal()

graph_b <- ggplot(data = amphib_old, aes(x = reorder(lake, -frogs), y = frogs)) +
  geom_col() +
  labs(x = "Lake ID",
       y = "Frog Count",
       title = "Adult and Sub-Adult Mountain Yellow-Legged Frogs by Lake") +
  theme_minimal()

graph_a / graph_b
```

**Figure 1**: Counts of mountain yellow-legged frogs observed in the Southern Sierra Nevada from 1995 to 2002. Top shows frog counts of adult, subadult, and tadpole individuals over time. Bottom shows the lakes with the largest number of adult and subadults observed during this time period. The top 5 lake counts are shown.

Data Citation: Knapp, R.A., C. Pavelka, E.E. Hegeman, and T.C. Smith. 2020. The Sierra Lakes Inventory Project: Non-Native fish and community composition of lakes and ponds in the Sierra Nevada, California ver 2. Environmental Data Initiative. https://doi.org/10.6073/pasta/d835832d7fd00d9e4466e44eea87fab3

